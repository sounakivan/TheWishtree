var Vr=pc.createScript("vr");Vr.attributes.add("buttonVr",{type:"entity",title:"VR Button"}),Vr.attributes.add("elementUnsupported",{type:"entity",title:"Unsupported Message"}),Vr.attributes.add("elementUnavailable",{type:"entity",title:"Unavailable Message"}),Vr.attributes.add("elementHttpsRequired",{type:"entity",title:"HTTPS Required Message"}),Vr.attributes.add("cameraEntity",{type:"entity",title:"Camera"}),Vr.prototype.initialize=function(){this.app.xr.on("available:"+pc.XRTYPE_VR,this.checkButton,this),this.app.xr.on("start",this.checkButton,this),this.app.xr.on("end",this.checkButton,this),this.buttonVr.element.on("click",(function(){this.sessionStart()}),this),this.app.keyboard.on("keydown",(function(t){t.key===pc.KEY_ESCAPE&&this.app.xr.active&&this.app.xr.end()}),this),this.checkButton()},Vr.prototype.checkButton=function(){if(this.app.xr.supported)if(this.elementHttpsRequired.enabled=!1,this.app.xr.active)this.buttonVr.enabled=!1;else{var t=this.app.xr&&!this.app.xr.active&&this.app.xr.isAvailable(pc.XRTYPE_VR);this.buttonVr.enabled=t}else this.buttonVr.enabled=!1,this.elementUnavailable.enabled=!1,"https:"==window.location.protocol&&(this.elementUnsupported.enabled=!0,this.elementHttpsRequired.enabled=!1)},Vr.prototype.sessionStart=function(){this.app.xr.supported&&(this.app.xr.active||this.app.xr.isAvailable(pc.XRTYPE_VR)&&(window.DeviceOrientationEvent&&window.DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(function(t){"granted"===t&&window.addEventListener("deviceorientation",function(t){this.cameraEntity.camera.startXr(pc.XRTYPE_VR,pc.XRSPACE_LOCALFLOOR)}.bind(this))}.bind(this)).catch(console.error):this.cameraEntity.camera.startXr(pc.XRTYPE_VR,pc.XRSPACE_LOCALFLOOR)))};var Controllers=pc.createScript("controllers");Controllers.attributes.add("controllerTemplate",{type:"asset",assetType:"template",title:"Controller Template"}),Controllers.prototype.initialize=function(){this.controllerAssets=this.app.assets.findByTag("controller"),this.controllerAssetsIndex={};for(var e=0;e<this.controllerAssets.length;e++){var t=this.controllerAssets[e].name.replace(/\.[a-z]+$/i,"");this.controllerAssetsIndex[t]=this.controllerAssets[e]}this.app.xr.input.on("add",(function(e){for(var t=this.controllerTemplate.resource.instantiate(),r=null,s=0;s<e.profiles.length;s++){var l=e.profiles[s]+"-"+e.handedness;if(r=this.controllerAssetsIndex[l])break}r||(r=this.controllerAssetsIndex["generic-trigger-"+(e.handedness||"none")]),t.reparent(this.app.root),t.script.controller.setInputSource(e,r),t.enabled=!0}),this)};var Controller=pc.createScript("controller");Controller.prototype.initialize=function(){this.modelEntity=this.entity.findByName("Model")},Controller.prototype.setInputSource=function(t,i){var e=this;if(this.inputSource=t,this.inputSource.once("remove",this.onRemove,this),this.on("hover",this.onHover,this),this.on("blur",this.onBlur,this),t.hand){this.joints=[];for(var o=new pc.StandardMaterial,n=0;n<t.hand.joints.length;n++){var s=t.hand.joints[n],a=new pc.Entity;a.addComponent("model",{type:"box"}),a.joint=s,a.model.material=o,this.joints.push(a),this.entity.addChild(a)}t.hand.on("trackinglost",(function(){this.joints[0].model.material.diffuse.set(1,0,0),this.joints[0].model.material.update()}),this),t.hand.on("tracking",(function(){this.joints[0].model.material.diffuse.set(1,1,1),this.joints[0].model.material.update()}),this)}else i&&(i.ready((function(){if(this.entity.parent){var t=i.resource,o=new Blob([t]);this.app.assets.loadFromUrlAndFilename(URL.createObjectURL(o),"container.glb","container",(function(t,i){if(!e.entity.parent)return i.unload(),void e.app.assets.remove(i);t?console.error(t):(e.modelEntity.setLocalScale(1,1,1),e.modelEntity.model.type="asset",e.modelEntity.model.asset=i.resource.model,e.modelEntity.containerAsset=i)}))}}),this),this.app.assets.load(i))},Controller.prototype.onRemove=function(){this.modelEntity.containerAsset&&(console.log(this.modelEntity.containerAsset),this.modelEntity.containerAsset.unload(),this.app.assets.remove(this.modelEntity.containerAsset),this.modelEntity.containerAsset=null),this.entity.destroy()},Controller.prototype.update=function(t){if(this.inputSource&&this.inputSource.hand)for(var i=0;i<this.joints.length;i++){var e=this.joints[i].joint,o=2*e.radius;this.joints[i].setLocalScale(o,o,o),this.joints[i].setPosition(e.getPosition()),this.joints[i].setRotation(e.getRotation())}else this.inputSource&&this.inputSource.grip?(this.modelEntity.enabled=!0,this.entity.setPosition(this.inputSource.getPosition()),this.entity.setRotation(this.inputSource.getRotation())):(this.modelEntity.enabled=!1,this.inputSource&&"gaze"!==this.inputSource.targetRayMode||(this.entity.setPosition(this.app.mainCamera.getPosition()),this.entity.setRotation(this.app.mainCamera.getRotation())))};var Network=pc.createScript("network");Network.id=null,Network.socket=null,Network.prototype.initialize=function(){this.player=this.app.root.findByName("Camera Offset"),this.other=this.app.root.findByName("Other Camera Offset");var t=io.connect("https://networking-playcanvas.glitch.me");Network.socket=t,t.emit("initialize");var i=this;t.on("playerData",(function(t){i.initializePlayers(t)})),t.on("playerJoined",(function(t){i.addPlayer(t)})),t.on("playerMoved",(function(t){i.movePlayer(t)})),t.on("killPlayer",(function(t){i.removePlayer(t)})),t.on("spawnLanterns",(function(t){i.initializeLanterns(t)})),t.on("spawnLotus",(function(t){i.initializeLotus(t)}))},Network.prototype.initializeLanterns=function(t){for(i=0;i<t;i++){var e=this.app.assets.get(46890031).resource.instantiate();e.setLocalPosition(pc.math.random(-100,100),pc.math.random(30,90),pc.math.random(-100,100)),this.app.root.addChild(e)}},Network.prototype.initializeLotus=function(t){for(i=0;i<t;i++){var e=this.app.assets.get(49143190).resource.instantiate();e.setLocalPosition(pc.math.random(-50,50),pc.math.random(2.65,2.65),pc.math.random(-50,50)),this.app.root.addChild(e)}},Network.prototype.initializePlayers=function(t){for(var i in this.players=t.players,Network.id=t.id,this.players)i!=Network.id&&(this.players[i].entity=this.createPlayerEntity(this.players[i]));this.initialized=!0,console.log("initialized")},Network.prototype.addPlayer=function(t){this.players[t.id]=t,this.players[t.id].entity=this.createPlayerEntity(t)},Network.prototype.movePlayer=function(t){this.initialized&&!this.players[t.id].deleted&&this.players[t.id].entity.setPosition(t.x,t.y,t.z)},Network.prototype.removePlayer=function(t){this.players[t].entity&&(this.players[t].entity.destroy(),this.players[t].deleted=!0)},Network.prototype.createPlayerEntity=function(t){var i=this.other.clone();return i.enabled=!0,this.other.getParent().addChild(i),t&&i.setPosition(t.x,t.y,t.z),i},Network.prototype.update=function(t){this.updatePosition()},Network.prototype.updatePosition=function(){if(this.initialized){var t=this.player.getPosition();Network.socket.emit("positionUpdate",{id:Network.id,x:t.x,y:t.y,z:t.z})}};var FirstPersonMovement=pc.createScript("firstPersonMovement");FirstPersonMovement.attributes.add("camera",{type:"entity",description:"Optional, assign a camera entity, otherwise one is created"}),FirstPersonMovement.attributes.add("power",{type:"number",default:2500,description:"Adjusts the speed of player movement"}),FirstPersonMovement.attributes.add("lookSpeed",{type:"number",default:.25,description:"Adjusts the sensitivity of looking"}),FirstPersonMovement.prototype.initialize=function(){this.force=new pc.Vec3,this.eulers=new pc.Vec3;var e=this.app;e.mouse.on("mousemove",this._onMouseMove,this),e.mouse.on("mousedown",(function(){e.mouse.enablePointerLock()}),this),this.entity.collision||console.error("First Person Movement script needs to have a 'collision' component"),this.entity.rigidbody&&this.entity.rigidbody.type===pc.BODYTYPE_DYNAMIC||console.error("First Person Movement script needs to have a DYNAMIC 'rigidbody' component")},FirstPersonMovement.prototype.update=function(e){this.camera||this._createCamera();var t=this.force,s=this.app,o=this.camera.forward,i=this.camera.right,r=0,a=0;this.app.xr.active&&(this.app.xr.input.inputSources.forEach((function(e){e.gamepad.buttons[0].value&&(r+=o.x,a+=o.z)})),this.power=3e3);this.app.xr.active||((s.keyboard.isPressed(pc.KEY_A)||s.keyboard.isPressed(pc.KEY_LEFT))&&(r-=i.x,a-=i.z),(s.keyboard.isPressed(pc.KEY_D)||s.keyboard.isPressed(pc.KEY_RIGHT))&&(r+=i.x,a+=i.z),(s.keyboard.isPressed(pc.KEY_W)||s.keyboard.isPressed(pc.KEY_UP))&&(r+=o.x,a+=o.z),(s.keyboard.isPressed(pc.KEY_S)||s.keyboard.isPressed(pc.KEY_DOWN))&&(r-=o.x,a-=o.z)),0!==r&&0!==a&&(t.set(r,0,a).normalize().scale(this.power),this.entity.rigidbody.applyForce(t)),this.camera.setLocalEulerAngles(this.eulers.y,this.eulers.x,0)},FirstPersonMovement.prototype._onMouseMove=function(e){(pc.Mouse.isPointerLocked()||e.buttons[0])&&(this.eulers.x-=this.lookSpeed*e.dx,this.eulers.y-=this.lookSpeed*e.dy)},FirstPersonMovement.prototype._createCamera=function(){this.camera=new pc.Entity,this.camera.setName("First Person Camera"),this.camera.addComponent("camera"),this.entity.addChild(this.camera),this.camera.translateLocal(0,.5,0)};var Turn=pc.createScript("turn");Turn.attributes.add("turnSpeed",{type:"number",title:"Turn Speed",default:10}),Turn.prototype.update=function(t){this.entity.rotate(0,t*this.turnSpeed,0)};var BtnStates=pc.createScript("btnStates");BtnStates.socket=null,BtnStates.attributes.add("hoverAsset",{type:"asset",assetType:"texture"}),BtnStates.attributes.add("activeAsset",{type:"asset",assetType:"texture"}),BtnStates.attributes.add("buttonType",{type:"string",default:"",title:"Button Type"}),BtnStates.prototype.initialize=function(){var t=io.connect("https://networking-playcanvas.glitch.me");BtnStates.socket=t,this.originalTexture=this.entity.element.textureAsset,this.hovered=!1,this.entity.element.on("mouseenter",this.onEnter,this),this.entity.element.on("mousedown",this.onPress,this),this.entity.element.on("mouseup",this.onRelease,this),this.entity.element.on("mouseleave",this.onLeave,this),this.entity.element.on("touchstart",this.onPress,this),this.entity.element.on("touchend",this.onRelease,this);var e=this.app;this.startScreen=e.root.findByName("Start"),this.startScreen2=e.root.findByName("Start2"),this.welcomeScreen=e.root.findByName("Welcome"),this.onboard1=e.root.findByName("Onboarding1"),this.onboard2=e.root.findByName("Onboarding-2"),this.onboard3=e.root.findByName("Onboarding-3"),this.onboard4=e.root.findByName("Onboarding-4"),this.butterfly=e.root.findByName("Butterfly"),this.lantern=e.root.findByName("Lantern"),this.lotus=e.root.findByName("Lotus")},BtnStates.prototype.onEnter=function(t){this.hovered=!0,t.element.textureAsset=this.hoverAsset,document.body.style.cursor="pointer"},BtnStates.prototype.onLeave=function(t){this.hovered=!1,t.element.textureAsset=this.originalTexture,document.body.style.cursor="default"},BtnStates.prototype.onPress=function(t){t.element.textureAsset=this.activeAsset,!0===this.welcomeScreen.enabled?"No"===this.buttonType?(this.onboard1.enabled=!0,this.welcomeScreen.enabled=!1):"Yes"===this.buttonType&&(this.startScreen2.enabled=!0,this.butterfly.enabled=!0,this.welcomeScreen.enabled=!1):!0===this.onboard1.enabled?"Continue"===this.buttonType&&(this.onboard2.enabled=!0,this.onboard1.enabled=!1):!0===this.onboard3.enabled?"Next"===this.buttonType&&(this.onboard4.enabled=!0,this.lotus.enabled=!0,this.lantern.enabled=!1,this.onboard3.enabled=!1):!0===this.onboard4.enabled&&"Wish"===this.buttonType&&(this.startScreen.enabled=!0,this.butterfly.enabled=!0,BtnStates.socket.emit("addedLotus"),this.lotus.enabled=!1,this.onboard4.enabled=!1)},BtnStates.prototype.onRelease=function(t){t.element.textureAsset=this.hovered?this.hoverAsset:this.originalTexture};var ChangeScene=pc.createScript("changeScene");ChangeScene.attributes.add("hoverAsset",{type:"asset",assetType:"texture"}),ChangeScene.attributes.add("activeAsset",{type:"asset",assetType:"texture"}),ChangeScene.attributes.add("sceneName",{type:"string",default:"",title:"Scene Name to Load"}),ChangeScene.prototype.initialize=function(){this.originalTexture=this.entity.element.textureAsset,this.hovered=!1,this.entity.element.on("mouseenter",this.onEnter,this),this.entity.element.on("mousedown",this.onPress,this),this.entity.element.on("mouseup",this.onRelease,this),this.entity.element.on("mouseleave",this.onLeave,this),this.entity.element.on("touchstart",this.onPress,this),this.entity.element.on("touchend",this.onRelease,this)},ChangeScene.prototype.onEnter=function(e){this.hovered=!0,e.element.textureAsset=this.hoverAsset,document.body.style.cursor="pointer"},ChangeScene.prototype.onLeave=function(e){this.hovered=!1,e.element.textureAsset=this.originalTexture,document.body.style.cursor="default"},ChangeScene.prototype.onPress=function(e){e.element.textureAsset=this.activeAsset,console.log("button was pressed"),this.loadScene(this.sceneName)},ChangeScene.prototype.onRelease=function(e){e.element.textureAsset=this.hovered?this.hoverAsset:this.originalTexture},ChangeScene.prototype.loadScene=function(e){var t=this.app.root.findByName("Root"),n=this.app.scenes.find(e);this.app.scenes.loadSceneHierarchy(n.url,(function(e,n){e?console.error(e):t.destroy()}))};var BtnYesNo=pc.createScript("btnYesNo");BtnYesNo.socket=null,BtnYesNo.attributes.add("hoverAsset",{type:"asset",assetType:"texture"}),BtnYesNo.attributes.add("activeAsset",{type:"asset",assetType:"texture"}),BtnYesNo.attributes.add("option",{type:"boolean",title:"Yes",default:!1}),BtnYesNo.prototype.initialize=function(){var e=io.connect("https://networking-playcanvas.glitch.me");BtnYesNo.socket=e,this.originalTexture=this.entity.element.textureAsset,this.hovered=!1,this.entity.element.on("mouseenter",this.onEnter,this),this.entity.element.on("mousedown",this.onPress,this),this.entity.element.on("mouseup",this.onRelease,this),this.entity.element.on("mouseleave",this.onLeave,this),this.entity.element.on("touchstart",this.onPress,this),this.entity.element.on("touchend",this.onRelease,this);var t=this.app;this.onboard2=t.root.findByName("Onboarding-2"),this.onboard3=t.root.findByName("Onboarding-3"),this.onboard4=t.root.findByName("Onboarding-4"),this.lantern=t.root.findByName("Lantern"),this.lotus=t.root.findByName("Lotus")},BtnYesNo.prototype.onEnter=function(e){this.hovered=!0,e.element.textureAsset=this.hoverAsset,document.body.style.cursor="pointer"},BtnYesNo.prototype.onLeave=function(e){this.hovered=!1,e.element.textureAsset=this.originalTexture,document.body.style.cursor="default"},BtnYesNo.prototype.onPress=function(e){e.element.textureAsset=this.activeAsset,!0===this.onboard2.enabled&&(!0===this.option?(this.onboard3.enabled=!0,this.onboard2.enabled=!1,this.lantern.enabled=!0,BtnYesNo.socket.emit("addedLantern")):(this.onboard4.enabled=!0,this.lotus.enabled=!0,this.onboard2.enabled=!1))},BtnYesNo.prototype.onRelease=function(e){e.element.textureAsset=this.hovered?this.hoverAsset:this.originalTexture};var Halo=pc.createScript("halo");Halo.attributes.add("camera",{type:"entity"}),Halo.attributes.add("unidirectional",{type:"boolean",default:!1}),Halo.tmp=new pc.Vec3,Halo.prototype.initialize=function(){this.plane=this.entity.getChildren()[0],this.parent=this.entity.getParent()},Halo.prototype.update=function(t){var a=Halo.tmp;a.copy(this.parent.forward).scale(-1);var e=this.plane.model.meshInstances;if(this.camera)if(this.entity.lookAt(this.camera.getPosition()),this.unidirectional){var i=-1*a.dot(this.camera.forward);i<0&&(i=0),e[0].setParameter("material_opacity",i)}else e[0].setParameter("material_opacity",1)};var AnimatePosition=pc.createScript("animatePosition");AnimatePosition.attributes.add("offsetCurve",{type:"curve",title:"Offset Curve",curves:["x","y","z"]}),AnimatePosition.attributes.add("duration",{type:"number",default:3,title:"Duration (secs)"}),AnimatePosition.prototype.initialize=function(){this.startPosition=this.entity.getPosition().clone(),this.position=new pc.Vec3,this.time=0},AnimatePosition.prototype.update=function(t){this.time+=t,this.time>this.duration&&(this.time-=this.duration);var i=this.time/this.duration,o=this.offsetCurve.value(i);this.position.copy(this.startPosition),this.position.x+=o[0],this.position.y+=o[1],this.position.z+=o[2],this.entity.setPosition(this.position)};pc.script.attribute("materials","asset",[],{type:"material"}),pc.script.attribute("shader","asset",[],{type:"shader",max:1});var Plasma=pc.createScript("plasma");Plasma.attributes.add("materials",{type:"asset",array:!0}),Plasma.attributes.add("shader",{type:"asset"}),Plasma.prototype.initialize=function(){for(var t=this.shader.resource,a=0;a<this.materials.length;a++){var e=this.materials[a].resource;e.chunks.emissiveConstPS=t,e.diffuseMap=new pc.Texture(this.app.graphicsDevice,{width:1,height:1,format:pc.PIXELFORMAT_R8_G8_B8}),e.setParameter("iGlobalTime",0),e.update()}this.time=0},Plasma.prototype.update=function(t){this.time+=t;for(var a=0;a<this.materials.length;a++){this.materials[a].resource.setParameter("iGlobalTime",this.time)}};pc.extend(pc,function(){function computeGaussian(e,t){return 1/Math.sqrt(2*Math.PI*t)*Math.exp(-e*e/(2*t*t))}function calculateBlurValues(e,t,s,o,r){e[0]=computeGaussian(0,r),t[0]=0,t[1]=0;var i,a,l=e[0];for(i=0,a=Math.floor(7.5);i<a;i++){var u=computeGaussian(i+1,r);e[2*i]=u,e[2*i+1]=u,l+=2*u;var h=2*i+1.5;t[4*i]=s*h,t[4*i+1]=o*h,t[4*i+2]=-s*h,t[4*i+3]=-o*h}for(i=0,a=e.length;i<a;i++)e[i]/=l}var BloomEffect=function(e){var t={aPosition:pc.SEMANTIC_POSITION},s=["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition + 1.0) * 0.5;","}"].join("\n"),o=["precision "+e.precision+" float;","","varying vec2 vUv0;","","uniform sampler2D uBaseTexture;","uniform float uBloomThreshold;","","void main(void)","{","    vec4 color = texture2D(uBaseTexture, vUv0);","","    gl_FragColor = clamp((color - uBloomThreshold) / (1.0 - uBloomThreshold), 0.0, 1.0);","}"].join("\n"),r=["precision "+e.precision+" float;","","#define SAMPLE_COUNT 15","","varying vec2 vUv0;","","uniform sampler2D uBloomTexture;","uniform vec2 uBlurOffsets[SAMPLE_COUNT];","uniform float uBlurWeights[SAMPLE_COUNT];","","void main(void)","{","    vec4 color = vec4(0.0);","    for (int i = 0; i < SAMPLE_COUNT; i++)","    {","        color += texture2D(uBloomTexture, vUv0 + uBlurOffsets[i]) * uBlurWeights[i];","    }","","    gl_FragColor = color;","}"].join("\n"),i=["precision "+e.precision+" float;","","varying vec2 vUv0;","","uniform float uBloomEffectIntensity;","uniform sampler2D uBaseTexture;","uniform sampler2D uBloomTexture;","","void main(void)","{","    vec4 bloom = texture2D(uBloomTexture, vUv0) * uBloomEffectIntensity;","    vec4 base = texture2D(uBaseTexture, vUv0);","","    base *= (1.0 - clamp(bloom, 0.0, 1.0));","","    gl_FragColor = base + bloom;","}"].join("\n");this.extractShader=new pc.Shader(e,{attributes:t,vshader:s,fshader:o}),this.blurShader=new pc.Shader(e,{attributes:t,vshader:s,fshader:r}),this.combineShader=new pc.Shader(e,{attributes:t,vshader:s,fshader:i});var a=e.width,l=e.height;this.targets=[];for(var u=0;u<2;u++){var h=new pc.Texture(e,{format:pc.PIXELFORMAT_R8_G8_B8_A8,width:a>>1,height:l>>1});h.minFilter=pc.FILTER_LINEAR,h.magFilter=pc.FILTER_LINEAR,h.addressU=pc.ADDRESS_CLAMP_TO_EDGE,h.addressV=pc.ADDRESS_CLAMP_TO_EDGE;var n=new pc.RenderTarget(e,h,{depth:!1});this.targets.push(n)}this.bloomThreshold=.25,this.blurAmount=4,this.bloomIntensity=1.25,this.sampleWeights=new Float32Array(15),this.sampleOffsets=new Float32Array(30)};return(BloomEffect=pc.inherits(BloomEffect,pc.PostEffect)).prototype=pc.extend(BloomEffect.prototype,{render:function(e,t,s){var o=this.device,r=o.scope;r.resolve("uBloomThreshold").setValue(this.bloomThreshold),r.resolve("uBaseTexture").setValue(e.colorBuffer),pc.drawFullscreenQuad(o,this.targets[0],this.vertexBuffer,this.extractShader),calculateBlurValues(this.sampleWeights,this.sampleOffsets,1/this.targets[1].width,0,this.blurAmount),r.resolve("uBlurWeights[0]").setValue(this.sampleWeights),r.resolve("uBlurOffsets[0]").setValue(this.sampleOffsets),r.resolve("uBloomTexture").setValue(this.targets[0].colorBuffer),pc.drawFullscreenQuad(o,this.targets[1],this.vertexBuffer,this.blurShader),calculateBlurValues(this.sampleWeights,this.sampleOffsets,0,1/this.targets[0].height,this.blurAmount),r.resolve("uBlurWeights[0]").setValue(this.sampleWeights),r.resolve("uBlurOffsets[0]").setValue(this.sampleOffsets),r.resolve("uBloomTexture").setValue(this.targets[1].colorBuffer),pc.drawFullscreenQuad(o,this.targets[0],this.vertexBuffer,this.blurShader),r.resolve("uBloomEffectIntensity").setValue(this.bloomIntensity),r.resolve("uBloomTexture").setValue(this.targets[0].colorBuffer),r.resolve("uBaseTexture").setValue(e.colorBuffer),pc.drawFullscreenQuad(o,t,this.vertexBuffer,this.combineShader,s)}}),{BloomEffect:BloomEffect}}());var Bloom=pc.createScript("bloom");Bloom.attributes.add("bloomIntensity",{type:"number",default:1,min:0,title:"Intensity"}),Bloom.attributes.add("bloomThreshold",{type:"number",default:.25,min:0,max:1,precision:2,title:"Threshold"}),Bloom.attributes.add("blurAmount",{type:"number",default:4,min:1,title:"Blur amount"}),Bloom.prototype.initialize=function(){this.effect=new pc.BloomEffect(this.app.graphicsDevice),this.effect.bloomThreshold=this.bloomThreshold,this.effect.blurAmount=this.blurAmount,this.effect.bloomIntensity=this.bloomIntensity;var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("attr",(function(e,t){this.effect[e]=t}),this),this.on("state",(function(t){t?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect)}))};pc.extend(pc,function(){var BrightnessContrastEffect=function(t){this.shader=new pc.Shader(t,{attributes:{aPosition:pc.SEMANTIC_POSITION},vshader:["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition.xy + 1.0) * 0.5;","}"].join("\n"),fshader:["precision "+t.precision+" float;","uniform sampler2D uColorBuffer;","uniform float uBrightness;","uniform float uContrast;","varying vec2 vUv0;","void main() {","gl_FragColor = texture2D( uColorBuffer, vUv0 );","gl_FragColor.rgb += uBrightness;","if (uContrast > 0.0) {","gl_FragColor.rgb = (gl_FragColor.rgb - 0.5) / (1.0 - uContrast) + 0.5;","} else {","gl_FragColor.rgb = (gl_FragColor.rgb - 0.5) * (1.0 + uContrast) + 0.5;","}","}"].join("\n")}),this.brightness=0,this.contrast=0};return(BrightnessContrastEffect=pc.inherits(BrightnessContrastEffect,pc.PostEffect)).prototype=pc.extend(BrightnessContrastEffect.prototype,{render:function(t,e,r){var s=this.device,i=s.scope;i.resolve("uBrightness").setValue(this.brightness),i.resolve("uContrast").setValue(this.contrast),i.resolve("uColorBuffer").setValue(t.colorBuffer),pc.drawFullscreenQuad(s,e,this.vertexBuffer,this.shader,r)}}),{BrightnessContrastEffect:BrightnessContrastEffect}}());var BrightnessContrast=pc.createScript("brightnessContrast");BrightnessContrast.attributes.add("brightness",{type:"number",default:0,min:-1,max:1,precision:5,title:"Brightness"}),BrightnessContrast.attributes.add("contrast",{type:"number",default:0,min:-1,max:1,precision:5,title:"Contrast"}),BrightnessContrast.prototype.initialize=function(){this.effect=new pc.BrightnessContrastEffect(this.app.graphicsDevice),this.effect.brightness=this.brightness,this.effect.contrast=this.contrast,this.on("attr",(function(t,e){this.effect[t]=e}),this);var t=this.entity.camera.postEffects;t.addEffect(this.effect),this.on("state",(function(e){e?t.addEffect(this.effect):t.removeEffect(this.effect)})),this.on("destroy",(function(){t.removeEffect(this.effect)}))};var SpawnLanterns=pc.createScript("spawnLanterns");SpawnLanterns.attributes.add("numLanterns",{type:"number",default:100}),SpawnLanterns.prototype.initialize=function(){for(i=0;i<this.numLanterns;i++)this.generate()},SpawnLanterns.prototype.update=function(t){},SpawnLanterns.prototype.generate=function(){var t=this.app.assets.get(46890031).resource.instantiate();t.setLocalPosition(pc.math.random(-100,100),pc.math.random(30,90),pc.math.random(-100,100)),this.app.root.addChild(t)};var BtnCredits=pc.createScript("btnCredits");BtnCredits.attributes.add("hoverAsset",{type:"asset",assetType:"texture"}),BtnCredits.attributes.add("activeAsset",{type:"asset",assetType:"texture"}),BtnCredits.openCredits=!1,BtnCredits.openControls=!1,BtnCredits.attributes.add("buttonType",{type:"string",default:"",title:"Button Type"}),BtnCredits.prototype.initialize=function(){this.originalTexture=this.entity.element.textureAsset,this.hovered=!1,this.entity.element.on("mouseenter",this.onEnter,this),this.entity.element.on("mousedown",this.onPress,this),this.entity.element.on("mouseup",this.onRelease,this),this.entity.element.on("mouseleave",this.onLeave,this),this.entity.element.on("touchstart",this.onPress,this),this.entity.element.on("touchend",this.onRelease,this);var t=this.app;this.credits=t.root.findByName("Credits"),this.credits.enabled=!1,this.controls=t.root.findByName("Controls"),this.controls.enabled=!1},BtnCredits.prototype.onEnter=function(t){this.hovered=!0,t.element.textureAsset=this.hoverAsset,document.body.style.cursor="pointer"},BtnCredits.prototype.onLeave=function(t){this.hovered=!1,t.element.textureAsset=this.originalTexture,document.body.style.cursor="default"},BtnCredits.prototype.onPress=function(t){t.element.textureAsset=this.activeAsset,"credits"===this.buttonType&&(!1===BtnCredits.openCredits?(BtnCredits.openCredits=!0,!0===this.controls.enabled&&(BtnCredits.openControls=!1)):BtnCredits.openCredits=!1),"controls"===this.buttonType&&(!1===BtnCredits.openControls?(BtnCredits.openControls=!0,!0===this.credits.enabled&&(BtnCredits.openCredits=!1)):BtnCredits.openControls=!1)},BtnCredits.prototype.update=function(t){!0===BtnCredits.openCredits?this.credits.enabled=!0:this.credits.enabled=!1,!0===BtnCredits.openControls?this.controls.enabled=!0:this.controls.enabled=!1},BtnCredits.prototype.onRelease=function(t){t.element.textureAsset=this.hovered?this.hoverAsset:this.originalTexture};pc.script.createLoadingScreen((function(e){var t,a;t=["body {","    background-color: #000000;","}","","#application-splash-wrapper {","    position: absolute;","    top: 0;","    left: 0;","    height: 100%;","    width: 100%;","    background-color: #000000;","}","","#application-splash {","    position: absolute;","    top: calc(30% - 28px);","    width: 264px;","    left: calc(50% - 132px);","}","","#application-splash img {","    width: 100%;","}","","#progress-bar-container {","    margin: 20px auto 0 auto;","    height: 2px;","    width: 100%;","    background-color: #1d292c;","}","","#progress-bar {","    width: 0%;","    height: 100%;","    background-color: #f60;","}","","@media (max-width: 480px) {","    #application-splash {","        width: 170px;","        left: calc(50% - 85px);","    }","}"].join("\n"),(a=document.createElement("style")).type="text/css",a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t)),document.head.appendChild(a),function(){var e=document.createElement("div");e.id="application-splash-wrapper",document.body.appendChild(e);var t=document.createElement("div");t.id="application-splash",e.appendChild(t),t.style.display="none";var a=document.createElement("img");a.src="https://i.imgur.com/hBeFR3z.png",t.appendChild(a),a.onload=function(){t.style.display="block"};var o=document.createElement("div");o.id="progress-bar-container",t.appendChild(o);var n=document.createElement("div");n.id="progress-bar",o.appendChild(n)}(),e.on("preload:end",(function(){e.off("preload:progress")})),e.on("preload:progress",(function(e){var t=document.getElementById("progress-bar");t&&(e=Math.min(1,Math.max(0,e)),t.style.width=100*e+"%")})),e.on("start",(function(){var e=document.getElementById("application-splash-wrapper");e.parentElement.removeChild(e)}))}));